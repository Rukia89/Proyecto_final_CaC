<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biblioteca App</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-5">
        <h1 class="mb-4">Gestión de Biblioteca</h1>
        
        <h2>Libros</h2>
        <div>
            <button class="btn btn-primary mb-3" onclick="obtenerLibros()">Mostrar Libros</button>
            <button class="btn btn-success mb-3" onclick="agregarLibro()">Agregar Libro</button>
        </div>
        <table id="librosTable" class="table table-striped" style="display: none;">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Título</th>
                    <th>Autor</th>
                    <th>Género</th>
                    <th>Disponible</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody id="librosTableBody">
            </tbody>
        </table>

    
        <div id="agregarLibroForm" style="display: none;">
            <h3>Agregar Nuevo Libro</h3>
            <form id="formAgregarLibro">
                <div class="form-group">
                    <label>Título:</label>
                    <input type="text" class="form-control" id="titulo" required>
                </div>
                <div class="form-group">
                    <label>Autor:</label>
                    <input type="text" class="form-control" id="autor" required>
                </div>
                <div class="form-group">
                    <label>Género:</label>
                    <input type="text" class="form-control" id="genero">
                </div>
                <button type="submit" class="btn btn-primary">Agregar</button>
                <button type="button" class="btn btn-secondary" onclick="cancelarAgregarLibro()">Cancelar</button>
            </form>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        
        function obtenerLibros() {
            $.get('http://localhost:5000/libros', function(data) {
                $('#librosTableBody').empty();
                data.forEach(function(libro) {
                    $('#librosTableBody').append(`
                        <tr>
                            <td>${libro.id}</td>
                            <td>${libro.titulo}</td>
                            <td>${libro.autor}</td>
                            <td>${libro.genero}</td>
                            <td>${libro.disponible ? 'Sí' : 'No'}</td>
                            <td>
                                <button class="btn btn-info btn-sm" onclick="editarLibro(${libro.id})">Editar</button>
                                <button class="btn btn-danger btn-sm" onclick="eliminarLibro(${libro.id})">Eliminar</button>
                            </td>
                        </tr>
                    `);
                });
                $('#librosTable').show();
            });
        }

        
        function agregarLibro() {
            $('#agregarLibroForm').show();
        }

        
        function cancelarAgregarLibro() {
            $('#agregarLibroForm').hide();
        }

        
        $('#formAgregarLibro').submit(function(event) {
            event.preventDefault();
            var titulo = $('#titulo').val();
            var autor = $('#autor').val();
            var genero = $('#genero').val();

            $.ajax({
                url: 'http://localhost:5000/libros',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ titulo: titulo, autor: autor, genero: genero }),
                success: function() {
                    alert('Libro agregado correctamente');
                    obtenerLibros();
                    $('#formAgregarLibro')[0].reset();
                    $('#agregarLibroForm').hide();
                },
                error: function() {
                    alert('Error al agregar libro');
                }
            });
        });

        
        function eliminarLibro(id) {
            if (confirm('¿Estás seguro de eliminar este libro?')) {
                $.ajax({
                    url: `http://localhost:5000/libros/${id}`,
                    type: 'DELETE',
                    success: function() {
                        alert('Libro eliminado correctamente');
                        obtenerLibros();
                    },
                    error: function() {
                        alert('Error al eliminar libro');
                    }
                });
            }
        }

        
        function editarLibro(id) {
            
        }
    </script>
</body>
</html>
